<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blacksmith Construction - Quality & Craftsmanship</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Load Lucide icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        /* Use Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #a0aec0; /* gray-500 */
            border-radius: 3px;
        }
        ::-webkit-scrollbar-track {
            background-color: #edf2f7; /* gray-200 */
        }
        
        /* Styles for the AI Modal */
        .modal {
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s ease;
        }
        
        /* Simple loading spinner */
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #ef4444; /* red-500 */
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Carousel Styles */
        .carousel-container {
            position: relative;
            overflow: hidden;
            width: 100%;
            padding-top: 66.66%; /* 3:2 aspect ratio (400/600) */
        }
        .carousel-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        .carousel-slide.active {
            opacity: 1;
        }
        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>
<body class="bg-white text-gray-900">

    <!-- Header & Navigation -->
    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-gray-200">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <!-- Logo and Company Name -->
            <a href="#" class="flex items-center gap-3 mr-8">
                <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/logo/Blacksmith%20Construction%202025.png" alt="Blacksmith Construction Logo" class="h-10 w-auto">
                <span class="text-xl md:text-2xl font-bold text-gray-900">Blacksmith<span class="text-red-500">Construction</span></span>
            </a>
            
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-red-500">
                <svg id="menu-icon-open" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                <svg id="menu-icon-close" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <!-- Desktop Navigation -->
            <ul class="hidden md:flex items-center space-x-6">
                <li><a href="#home" class="text-gray-700 hover:text-red-600 transition duration-300">Home</a></li>
                <li><a href="#services" class="text-gray-700 hover:text-red-600 transition duration-300">Services</a></li>
                <li><a href="#about" class="text-gray-700 hover:text-red-600 transition duration-300">About</a></li>
                <li><a href="#gallery" class="text-gray-700 hover:text-red-600 transition duration-300">Our Work</a></li>
                <li><a href="#contact" class="bg-red-600 hover:bg-red-700 text-white font-semibold px-5 py-2 rounded-lg transition duration-300 shadow-md whitespace-nowrap">Get a Quote</a></li>
            </ul>
        </nav>
        
        <!-- Mobile Navigation Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-b border-gray-200">
            <ul class="flex flex-col items-center py-4 space-y-4">
                <li><a href="#home" class="text-gray-700 hover:text-red-600 transition duration-300 block py-2">Home</a></li>
                <li><a href="#services" class="text-gray-700 hover:text-red-600 transition duration-300 block py-2">Services</a></li>
                <li><a href="#about" class="text-gray-700 hover:text-red-600 transition duration-300 block py-2">About</a></li>
                <li><a href="#gallery" class="text-gray-700 hover:text-red-600 transition duration-300 block py-2">Our Work</a></li>
                <li><a href="#contact" class="bg-red-600 hover:bg-red-700 text-white font-semibold px-5 py-2 rounded-lg transition duration-300 shadow-md w-11/12 text-center whitespace-nowrap">Get a Quote</a></li>
            </ul>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="home" class="relative min-h-[70vh] md:min-h-screen flex items-center justify-center text-center px-6 py-24 overflow-hidden">
            <!-- Background Image -->
            <div class="absolute inset-0 z-0">
                <img src="https://placehold.co/1920x1080/2D3748/1A202C" 
                     onerror="this.src='https://placehold.co/1920x1080/2D3748/1A202C?text=Building+Future'"
                     alt="Construction background" class="w-full h-full object-cover">
                <!-- Overlay -->
                <div class="absolute inset-0 bg-gray-100/70 backdrop-blur-sm"></div>
                <!-- Watermark Logo -->
                <div class="absolute inset-0 flex items-center justify-center">
                    <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/logo/Blacksmith%20Construction%202025.png" alt="Blacksmith Construction Watermark" class="w-1/4 md:w-1/6 opacity-50">
                </div>
            </div>
            
            <!-- Hero Content -->
            <div class="relative z-10">
                
                <h1 class="text-5xl md:text-7xl font-bold text-gray-900 mb-4 drop-shadow-md">
                    Building Your Vision
                </h1>
                <p class="text-xl md:text-2xl text-gray-900 max-w-3xl mb-8 drop-shadow-sm">
                    From concept to completion, Blacksmith Construction delivers quality, craftsmanship, and reliability you can trust.
                </p>
                <!-- Button moved out of the div and positioned absolutely -->
            </div>
            
            <a href="#contact" class="absolute z-8 bottom-8 sm:bottom-16 left-1/2 -translate-x-1/2 bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-300 shadow-lg transform hover:scale-105">
                Start Your Project Today
            </a>
        </section>

        <!-- Services Section -->
        <section id="services" class="py-20 md:py-28 bg-gray-100">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-4">Our Services</h2>
                <div class="h-1 bg-red-600 w-24 mx-auto mb-12"></div>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Service Card 1 -->
                    <div class="bg-white rounded-lg shadow-xl p-8 transform transition duration-500 hover:scale-105 hover:shadow-red-500/10">
                        <div class="flex-shrink-0 mb-4">
                            <i data-lucide="home" class="w-12 h-12 text-red-500"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-3">Custom Home Builds</h3>
                        <p class="text-gray-600">
                            We work with you to build the home of your dreams, managing every detail from the ground up with precision and care.
                        </p>
                    </div>
                    
                    <!-- Service Card 2 -->
                    <div class="bg-white rounded-lg shadow-xl p-8 transform transition duration-500 hover:scale-105 hover:shadow-red-500/10">
                        <div class="flex-shrink-0 mb-4">
                            <i data-lucide="hammer" class="w-12 h-12 text-red-500"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-3">Remodeling & Renovations</h3>
                        <p class="text-gray-600">
                            Transform your existing space. We specialize in kitchen, bathroom, and full-home renovations that enhance value and lifestyle.
                        </p>
                    </div>
                    
                    <!-- Service Card 3 -->
                    <div class="bg-white rounded-lg shadow-xl p-8 transform transition duration-500 hover:scale-105 hover:shadow-red-500/10">
                        <div class="flex-shrink-0 mb-4">
                            <i data-lucide="building" class="w-12 h-12 text-red-500"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-3">Commercial Contracting</h3>
                        <p class="text-gray-600">
                            High-quality commercial projects delivered on time and on budget, from office fit-outs to new retail construction.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="about" class="py-20 md:py-28 bg-white">
            <div class="container mx-auto px-6">
                <div class="flex flex-col lg:flex-row items-center gap-12">
                    <div class="lg:w-1/2">
                        <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/logo/OurTeamatWork_1.jpg"
                             alt="Our Team at Work" class="rounded-lg shadow-2xl w-full h-auto object-cover">
                    </div>
                    <div class="lg:w-1/2">
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">About Blacksmith <span class="text-red-500">Construction</span></h2>
                        <div class="h-1 bg-red-600 w-24 mb-6"></div>
                        <p class="text-gray-600 text-lg mb-4">
                           <span class="font-semibold">Blacksmith <span class="text-red-500">Construction</span></span> delivers craftsmanship you can count on. We’re built on integrity, hard work, and an unwavering commitment to excellence.
                        </p>
                        <p class="text-gray-600 mb-6">
                            Our mission is simple: forge lasting relationships by exceeding expectations through clear communication, transparent pricing, and results that stand the test of time.
                        </p>
                        <a href="#contact" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300">
                            Partner With Us
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery" class="py-20 md:py-28 bg-gray-100">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-4">Our Work</h2>
                <div class="h-1 bg-red-600 w-24 mx-auto mb-12"></div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    
                    <!-- Carousel 1: Kitchen Remodel -->
                    <div class="rounded-lg overflow-hidden shadow-lg">
                     <div class="carousel-container" data-carousel="kitchen">
                      <div class="carousel-slide active">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/kitchen/kitchen_7.png" alt="Kitchen Remodel 7" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/kitchen/kitchen_2.jpg" alt="Kitchen Remodel 2" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/kitchen/kitchen_3.jpeg" alt="Kitchen Remodel 3" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/kitchen/kitchen_4.JPEG" alt="Kitchen Remodel 4" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/kitchen/kitchen_5.png" alt="Kitchen Remodel 5" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/kitchen/kitchen_6.png" alt="Kitchen Remodel 6" class="w-full h-full object-cover">
                      </div>
                     </div>
                     <div class="p-4 bg-white">
                      <h3 class="text-xl font-bold text-gray-900 text-center">Kitchen Remodel</h3>
                     </div>
                    </div>


                    
                    <!-- Carousel 2: Bathroom Remodel -->
                    <div class="rounded-lg overflow-hidden shadow-lg">
                     <div class="carousel-container" data-carousel="bathroom">
                      <div class="carousel-slide active">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/Bathroom/bathroom_1.jpg" alt="Bathroom Remodel 1" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/Bathroom/bathroom_2.jpg" alt="Bathroom Remodel 2" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/Bathroom/bathroom_3.jpg" alt="Bathroom Remodel 3" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/Bathroom/bathroom_4.jpeg" alt="Bathroom Remodel 4" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/Bathroom/bathroom_5.jpg" alt="Bathroom Remodel 5" class="w-full h-full object-cover">
                      </div>
                     </div>
                     <div class="p-4 bg-white">
                      <h3 class="text-xl font-bold text-gray-900 text-center">Bathroom Remodel</h3>
                     </div>
                    </div>

                    
                    <!-- Carousel 3: General Contracting -->
                    <div class="rounded-lg overflow-hidden shadow-lg">
                     <div class="carousel-container" data-carousel="generalcontracting">
                      <div class="carousel-slide active">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/generalcontracting/generalcontracting_1.jpg" alt="General Contracting 1" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/generalcontracting/generalcontracting_2.jpg" alt="General Contracting 2" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/generalcontracting/generalcontracting_3.jpg" alt="General Contracting 3" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/generalcontracting/generalcontracting_4.jpg" alt="General Contracting 4" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/generalcontracting/generalcontracting_5.jpg" alt="General Contracting 5" class="w-full h-full object-cover">
                      </div>
                      <div class="carousel-slide">
                       <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/generalcontracting/generalcontracting_6.jpg" alt="General Contracting 6" class="w-full h-full object-cover">
                      </div>
                    </div>
                    <div class="p-4 bg-white">
                      <h3 class="text-xl font-bold text-gray-900 text-center">General Contracting</h3>
                    </div>
                </div>
               </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-20 md:py-28 bg-white">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-4">Get in Touch</h2>
                <div class="h-1 bg-red-600 w-24 mx-auto mb-12"></div>

                <div class="max-w-3xl mx-auto bg-gray-100 p-8 md:p-12 rounded-lg shadow-2xl">
                    <p class="text-center text-gray-600 text-lg mb-8">
                        Ready to start your next project? Send us a message and we'll get back to you to schedule a free consultation.
                    </p>
                    <form id="contact-form">
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label for="name" class="block text-gray-700 font-semibold mb-2">Full Name</label>
                                <input type="text" id="name" name="name" class="w-full px-4 py-3 bg-white text-gray-900 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                            </div>
                            <div>
                                <label for="email" class="block text-gray-700 font-semibold mb-2">Email Address</label>
                                <input type="email" id="email" name="email" class="w-full px-4 py-3 bg-white text-gray-900 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                            </div>
                            <div class="md:col-span-2">
                                <label for="phone" class="block text-gray-700 font-semibold mb-2">Phone Number</label>
                                <input type="tel" id="phone" name="phone" class="w-full px-4 py-3 bg-white text-gray-900 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="(Optional)">
                            </div>
                        </div>
                        <div class="mb-6">
                            <label for="message" class="block text-gray-700 font-semibold mb-2">Project Details</label>
                            <textarea id="message" name="message" rows="5" class="w-full px-4 py-3 bg-white text-gray-900 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Tell us about your project (e.g., 'I want to remodel my 1980s kitchen and add an island.')" required></textarea>
                        </div>
                        <div class="mb-6">
                            <label for="attachments" class="block text-gray-700 font-semibold mb-2">Add Photos (Optional)</label>
                            <input type="file" id="attachments" name="attachments[]" multiple accept="image/png, image/jpeg, image/jpg" class="w-full px-4 py-3 bg-white text-gray-900 rounded-lg border border-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-gray-200 file:text-gray-700 hover:file:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                            <a href="tel:16029355870" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-8 rounded-lg text-base transition duration-300 shadow-lg w-full sm:w-auto flex items-center justify-center gap-2 whitespace-nowrap">
                                <i data-lucide="phone" class="w-5 h-5"></i> 602-935-5870
                            </a>
                            <a href="mailto:new@blacksmith-az.com" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-8 rounded-lg text-base transition duration-300 shadow-lg w-full sm:w-auto flex items-center justify-center gap-2 whitespace-nowrap">
                                <i data-lucide="mail" class="w-5 h-5"></i> new@blacksmith-az.com
                            </a>
                            <button type="submit" id="send-message-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-lg text-base transition duration-300 shadow-lg transform hover:scale-105 w-full sm:w-auto whitespace-nowrap">
                                Send Message
                            </button>
                        </div>
                        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mt-4">
                             <button type="button" id="ai-ideas-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-base transition duration-300 shadow-lg transform hover:scale-105 w-full sm:w-auto flex items-center justify-center gap-2 whitespace-nowrap">
                                <span id="ai-btn-text">✨ Get AI Project Ideas</span>
                                <div id="ai-loading-spinner" class="loader w-6 h-6 border-2 border-white border-t-blue-300 hidden"></div>
                            </button>
                        </div>
                    </form>
                    <!-- Success/Error Message Box -->
                    <div id="form-message" class="mt-6 text-center text-lg hidden"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-100 border-t border-gray-200 pt-12 pb-8">
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center text-center md:text-left">
                <!-- Footer Logo & Info -->
                <div class="mb-6 md:mb-0">
                    <a href="#" class="flex items-center justify-center md:justify-start gap-3 mb-4">
                        <img src="https://cdn.jsdelivr.net/gh/brizzeez1/blacksmith-photos@main/images/logo/Blacksmith%20Construction%202025.png" alt="Blacksmith Construction Logo" class="h-10 w-auto">
                        <span class="text-xl font-bold text-gray-900">Blacksmith<span class="text-red-500">Construction</span></span>
                    </a>
                    <p class="text-gray-600">Forging Quality. Building Trust.</p>
                </div>
                
                <!-- Footer Links -->
                <div class="flex flex-col md:flex-row gap-8 md:gap-12 mb-6 md:mb-0">
                    <div>
                        <h4 class="font-bold text-gray-900 mb-3">Quick Links</h4>
                        <ul class="space-y-2">
                            <li><a href="#services" class="text-gray-600 hover:text-red-600 transition">Services</a></li>
                            <li><a href="#gallery" class="text-gray-600 hover:text-red-600 transition">Our Work</a></li>
                            <li><a href="#about" class="text-gray-600 hover:text-red-600 transition">About Us</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-900 mb-3">Contact</h4>
                        <ul class="space-y-2 text-gray-600">
                            <li class="flex items-center justify-center md:justify-start gap-2">
                                <i data-lucide="phone" class="w-4 h-4 text-red-500"></i>
                                <a href="tel:16029355870" class="hover:text-red-600">(602) 935-5870</a>
                            </li>
                            <li class="flex items-center justify-center md:justify-start gap-2">
                                <i data-lucide="mail" class="w-4 h-4 text-red-500"></i>
                                <a href="mailto:new@blacksmith-az.com" class="hover:text-red-600">new@blacksmith-az.com</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Copyright -->
            <div class="border-t border-gray-300 mt-8 pt-6 text-center">
                <p class="text-gray-500">&copy; <span id="current-year"></span> Blacksmith <span class="text-red-500">Construction</span>. All Rights Reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- AI Response Modal -->
    <div id="ai-modal" class="modal fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 invisible opacity-0">
        <div id="ai-modal-content-box" class="modal-content bg-white w-full max-w-2xl rounded-lg shadow-2xl p-6 md:p-8 transform scale-95">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold text-gray-900">AI Project Assistant ✨</h3>
                <button id="ai-modal-close-btn" class="text-gray-500 hover:text-gray-800 transition-colors">
                    <i data-lucide="x" class="w-8 h-8"></i>
                </button>
            </div>
            <div id="ai-modal-content" class="text-gray-700 max-h-[60vh] overflow-y-auto pr-2 space-y-4">
                <!-- AI content will be injected here -->
                <p>Loading your project ideas...</p>
            </div>
            <div class="mt-6 pt-4 border-t border-gray-200 flex flex-col sm:flex-row gap-4">
                <button id="tts-btn" class="bg-gray-700 hover:bg-gray-900 text-white font-semibold py-2 px-5 rounded-lg transition duration-300 flex items-center justify-center gap-2">
                    <span id="tts-btn-text">Read Aloud ✨</span>
                    <div id="tts-loading-spinner" class="loader w-5 h-5 border-2 border-white border-t-gray-400 hidden"></div>
                </button>
                <audio id="tts-audio" class="w-full sm:w-auto" controls></audio>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // --- Mobile Menu Toggle ---
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const menuIconOpen = document.getElementById('menu-icon-open');
            const menuIconClose = document.getElementById('menu-icon-close');

            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                menuIconOpen.classList.toggle('hidden');
                menuIconClose.classList.toggle('hidden');
            });
            
            // --- Close mobile menu when a link is clicked ---
            const mobileLinks = mobileMenu.querySelectorAll('a');
            mobileLinks.forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                    menuIconOpen.classList.remove('hidden');
                    menuIconClose.classList.add('hidden');
                });
            });

            // --- Set Current Year in Footer ---
            document.getElementById('current-year').textContent = new Date().getFullYear();

            // --- Contact Form Handling (Mock) ---
            const contactForm = document.getElementById('contact-form');
            const formMessage = document.getElementById('form-message');
            const sendMessageBtn = document.getElementById('send-message-btn');

            // --- Gemini API Elements ---
            const aiIdeasBtn = document.getElementById('ai-ideas-btn');
            const aiBtnText = document.getElementById('ai-btn-text');
            const aiLoadingSpinner = document.getElementById('ai-loading-spinner');
            const projectDetailsTextarea = document.getElementById('message');
            
            // --- Modal Elements ---
            const aiModal = document.getElementById('ai-modal');
            const aiModalContentBox = document.getElementById('ai-modal-content-box');
            const aiModalContent = document.getElementById('ai-modal-content');
            const aiModalCloseBtn = document.getElementById('ai-modal-close-btn');

            // --- TTS Elements ---
            const ttsBtn = document.getElementById('tts-btn');
            const ttsBtnText = document.getElementById('tts-btn-text');
            const ttsLoadingSpinner = document.getElementById('tts-loading-spinner');
            const ttsAudio = document.getElementById('tts-audio');
            let lastGeneratedText = ""; // Store AI text for TTS

            // --- Contact Form Handling ---
            contactForm.addEventListener('submit', (e) => {
                e.preventDefault();
                // This is a mock submission.
                // In a real app, you'd send this data (including files) to a server.
                sendMessageBtn.textContent = 'Sending...';
                sendMessageBtn.disabled = true;

                // Simulate a network request
                setTimeout(() => {
                    contactForm.reset();
                    sendMessageBtn.textContent = 'Send Message';
                    sendMessageBtn.disabled = false;
                    formMessage.textContent = 'Thank you! Your message has been sent.';
                    formMessage.classList.remove('hidden', 'text-red-600');
                    formMessage.classList.add('text-green-600');
                    
                    // Hide the message after 5 seconds
                    setTimeout(() => {
                        formMessage.classList.add('hidden');
                    }, 5000);
                }, 1500);
            });
            
            // --- AI Modal Listeners ---
            aiIdeasBtn.addEventListener('click', handleAIAssistClick);
            aiModalCloseBtn.addEventListener('click', closeModal);
            aiModal.addEventListener('click', (e) => {
                // Close modal if clicking on the background overlay
                if (e.target === aiModal) {
                    closeModal();
                }
            });

            // --- TTS Button Listener ---
            ttsBtn.addEventListener('click', handleTTSClick);

            function showModal() {
                aiModal.classList.remove('invisible', 'opacity-0');
                aiModalContentBox.classList.remove('scale-95');
            }

            function closeModal() {
                aiModal.classList.add('invisible', 'opacity-0');
                aiModalContentBox.classList.add('scale-95');
                // Stop any playing audio when modal closes
                ttsAudio.pause();
                ttsAudio.src = "";
            }

            // --- Show/Hide Form Message Utility ---
            function showFormMessage(message, isError = false) {
                formMessage.textContent = message;
                formMessage.classList.remove('hidden');
                if (isError) {
                    formMessage.classList.add('text-red-600');
                    formMessage.classList.remove('text-green-600');
                } else {
                    formMessage.classList.remove('text-red-600');
                    formMessage.classList.add('text-green-600');
                }
            }

            // --- Toggle AI Button Loading State ---
            function setAILoading(isLoading) {
                if (isLoading) {
                    aiBtnText.classList.add('hidden');
                    aiLoadingSpinner.classList.remove('hidden');
                    aiIdeasBtn.disabled = true;
                    sendMessageBtn.disabled = true;
                } else {
                    aiBtnText.classList.remove('hidden');
                    aiLoadingSpinner.classList.add('hidden');
                    aiIdeasBtn.disabled = false;
                    sendMessageBtn.disabled = false;
                }
            }
            
            // --- Toggle TTS Button Loading State ---
            function setTTSLoading(isLoading) {
                if (isLoading) {
                    ttsBtnText.classList.add('hidden');
                    ttsLoadingSpinner.classList.remove('hidden');
                    ttsBtn.disabled = true;
                } else {
                    ttsBtnText.classList.remove('hidden');
                    ttsLoadingSpinner.classList.add('hidden');
                    ttsBtn.disabled = false;
                }
            }

            // --- 1. Handle "Get AI Ideas" Click ---
            async function handleAIAssistClick() {
                const projectDetails = projectDetailsTextarea.value;

                if (projectDetails.trim().length < 10) {
                    showFormMessage('Please provide more details about your project first (at least 10 characters).', true);
                    return;
                }

                showFormMessage('Generating AI ideas...', false);
                setAILoading(true);
                aiModalContent.innerHTML = '<p>Generating your project ideas, please wait...</p>';
                ttsAudio.src = ""; // Clear previous audio
                lastGeneratedText = ""; // Clear previous text

                // System prompt for the AI
                const systemPrompt = `
                    You are a friendly and helpful project assistant for "Blacksmith Construction".
                    A potential client has provided a description of a project they are considering.
                    Your task is to provide a brief, encouraging, and helpful response.
                    
                    Respond in simple HTML format.
                    - Start with a friendly greeting.
                    - Briefly summarize their request to show you understand.
                    - Provide a bulleted list (<ul>) of 3-5 interesting ideas, key considerations, or potential next steps related to their project.
                    - Conclude with a friendly disclaimer that these are just ideas and a proper consultation is needed for a real quote and plan.
                    - Do not use <h1> or <h2> tags. Use <strong> for emphasis if needed.
                `;

                try {
                    const aiResponse = await callGeminiAPI(systemPrompt, projectDetails);
                    aiModalContent.innerHTML = aiResponse;
                    lastGeneratedText = aiModalContent.innerText; // Get the plain text for TTS
                    showModal();
                    showFormMessage('AI ideas generated successfully!', false);
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    aiModalContent.innerHTML = '<p class="text-red-600">Sorry, we couldn\'t generate ideas at this time. Please try again later.</p>';
                    showModal();
                    showFormMessage('Error generating AI ideas.', true);
                } finally {
                    setAILoading(false);
                    // Hide the form message after a few seconds
                    setTimeout(() => formMessage.classList.add('hidden'), 4000);
                }
            }

            // --- 2. Handle "Read Aloud" Click ---
            async function handleTTSClick() {
                if (!lastGeneratedText) {
                    aiModalContent.innerHTML += '<p class="text-red-600">No text to read aloud.</p>';
                    return;
                }

                setTTSLoading(true);
                ttsAudio.src = ""; // Clear previous audio

                try {
                    const ttsResponse = await callGeminiTTSAPI(lastGeneratedText);
                    const pcmData = base64ToArrayBuffer(ttsResponse.audioData);
                    const sampleRate = parseInt(ttsResponse.mimeType.match(/rate=(\d+)/)[1], 10);
                    
                    const pcm16 = new Int16Array(pcmData);
                    const wavBlob = pcmToWav(pcm16, sampleRate);
                    const audioUrl = URL.createObjectURL(wavBlob);
                    
                    ttsAudio.src = audioUrl;
                    ttsAudio.play();

                } catch (error) {
                    console.error('Error calling Gemini TTS API:', error);
                    // Display error in modal (or just log it)
                    aiModalContent.innerHTML += '<p class="text-red-600">Sorry, couldn\'t generate audio at this time.</p>';
                } finally {
                    setTTSLoading(false);
                }
            }

            // --- 3. Gemini API Call (Text) ---
            async function callGeminiAPI(systemPrompt, userQuery) {
                const apiKey = ""; // API key will be injected by the environment
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                };

                let response;
                let retries = 3;
                let delay = 1000;

                for (let i = 0; i < retries; i++) {
                    try {
                        response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (response.ok) {
                            const result = await response.json();
                            const candidate = result.candidates?.[0];
                            if (candidate && candidate.content?.parts?.[0]?.text) {
                                return candidate.content.parts[0].text;
                            } else {
                                throw new Error('Invalid response structure from Gemini API');
                            }
                        } else if (response.status === 429 || response.status >= 500) {
                            // Retry on rate limiting or server errors
                            if (i === retries - 1) throw new Error(`API request failed with status ${response.status}`);
                            await new Promise(resolve => setTimeout(resolve, delay));
                            delay *= 2; // Exponential backoff
                        } else {
                            // Don't retry on other client-side errors
                            throw new Error(`API request failed with status ${response.status}`);
                        }
                    } catch (error) {
                        if (i === retries - 1) throw error;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2;
                    }
                }
            }

            // --- 4. Gemini API Call (TTS) ---
            async function callGeminiTTSAPI(textToSpeak) {
                const apiKey = ""; // API key will be injected by the environment
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;

                // Guidance for the voice
                const prompt = `Say in a friendly, professional, and helpful tone: ${textToSpeak}`;

                const payload = {
                    contents: [{
                        parts: [{ text: prompt }]
                    }],
                    generationConfig: {
                        responseModalities: ["AUDIO"],
                        speechConfig: {
                            voiceConfig: {
                                prebuiltVoiceConfig: { voiceName: "Kore" } // A firm, clear voice
                            }
                        }
                    },
                    model: "gemini-2.5-flash-preview-tts"
                };

                let response;
                let retries = 3;
                let delay = 1000;

                for (let i = 0; i < retries; i++) {
                     try {
                        response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (response.ok) {
                            const result = await response.json();
                            const part = result?.candidates?.[0]?.content?.parts?.[0];
                            const audioData = part?.inlineData?.data;
                            const mimeType = part?.inlineData?.mimeType;

                            if (audioData && mimeType && mimeType.startsWith("audio/")) {
                                return { audioData, mimeType };
                            } else {
                                throw new Error('Invalid TTS response structure from Gemini API');
                            }
                        } else if (response.status === 429 || response.status >= 500) {
                            if (i === retries - 1) throw new Error(`TTS API request failed with status ${response.status}`);
                            await new Promise(resolve => setTimeout(resolve, delay));
                            delay *= 2;
                        } else {
                            throw new Error(`TTS API request failed with status ${response.status}`);
                        }
                    } catch (error) { // <-- FIXED: Added opening brace
                        if (i === retries - 1) throw error;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2;
                    } // <-- FIXED: Added closing brace
                }
            }
            
            // --- 5. Audio Helper Functions ---
            
            // Convert Base64 string to ArrayBuffer
            function base64ToArrayBuffer(base64) {
                const binaryString = window.atob(base64);
                const len = binaryString.length;
                const bytes = new Uint8Array(len);
                for (let i = 0; i < len; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                return bytes.buffer;
            }

            // Convert raw PCM16 data to a WAV file (Blob)
            function pcmToWav(pcmData, sampleRate) {
                const numSamples = pcmData.length;
                const numChannels = 1;
                const bytesPerSample = 2; // 16-bit
                const blockAlign = numChannels * bytesPerSample;
                const byteRate = sampleRate * blockAlign;
                const dataSize = numSamples * blockAlign;
                const buffer = new ArrayBuffer(44 + dataSize);
                const view = new DataView(buffer);

                // RIFF header
                writeString(view, 0, 'RIFF');
                view.setUint32(4, 36 + dataSize, true);
                writeString(view, 8, 'WAVE');
                
                // fmt chunk
                writeString(view, 12, 'fmt ');
                view.setUint32(16, 16, true); // chunk size
                view.setUint16(20, 1, true); // audio format (1 = PCM)
                view.setUint16(22, numChannels, true);
                view.setUint32(24, sampleRate, true);
                view.setUint32(28, byteRate, true);
                view.setUint16(32, blockAlign, true);
                view.setUint16(34, 16, true); // bits per sample
                
                // data chunk
                writeString(view, 36, 'data');
                view.setUint32(40, dataSize, true);

                // Write PCM data
                for (let i = 0; i < numSamples; i++) {
                    view.setInt16(44 + i * 2, pcmData[i], true);
                }

                return new Blob([view], { type: 'audio/wav' });
            }

            function writeString(view, offset, string) {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            }

            // --- 6. Carousel Logic ---
            function startCarousels() {
                const carousels = document.querySelectorAll('[data-carousel]');
                carousels.forEach(carousel => {
                    const slides = carousel.querySelectorAll('.carousel-slide');
                    let currentSlide = 0;
                    
                    function showSlide(index) {
                        slides.forEach((slide, i) => {
                            slide.classList.toggle('active', i === index);
                        });
                    }

                    function nextSlide() {
                        currentSlide = (currentSlide + 1) % slides.length;
                        showSlide(currentSlide);
                    }
                    
                    if (slides.length > 1) { // Only start interval if there's more than one slide
                        setInterval(nextSlide, 5000); // Change slide every 5 seconds
                    }
                });
            }
            
            startCarousels();

            // --- Initialize Lucide Icons ---
            lucide.createIcons();
        });
    </script>
</body>
</html>

